<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-bottom.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/cross-fade.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/hero-transition.html">

<link rel="import" href="../page-authorize/page-authorize.html">
<link rel="import" href="../page-rooms/page-rooms.html">
<link rel="import" href="../page-game/page-game.html">
<link rel="import" href="../game-board/game-board.html">


<polymer-element name="game-app" attributes="">
  <template>
    <link rel="stylesheet" href="game-app.css">

    <core-animated-pages id="pages" fit selected="0" transitions="slide-from-bottom">
      <section>
        <game-board></game-board>
      </section>
      <section>
        <page-authorize fit slide-from-bottom user="{{user}}"></page-authorize>
      </section>
      <section>
        <page-rooms slide-from-bottom user="{{user}}" player="{{player}}" roomId="{{roomId}}"></page-rooms>
      </section>
      <section>
        <page-game slide-from-bottom hero-id="game" user="{{user}}" player="{{player}}" roomId="{{roomId}}"></page-game>
      </section>
    </core-animated-pages>

  </template>
  <script src="../../bower_components/director/build/director.js"></script>
  <script>
    var debugApp;
    (function() {
      Polymer({
        user: null,
        player: null,
        roomId: null,

        ready: function() {
          var app = this;
          /// TODO: remove
          debugApp = this;

          var routes = {
            'authorize': function() {
              app.$.pages.selected = 0;
            },
            'rooms': function() {
              app.$.pages.selected = 1;
            },
            'game': function() {
              app.$.pages.selected = 2;
            }
          };

          this.addEventListener('change-route', function(e) {
            if (e.detail) {
              if (routes[e.detail]) {
                //window.history.pushState({route: routes[e.detail]}, routes[e.detail]);
                routes[e.detail]();
              }
            }
          });

          this.addEventListener('change-route-back', function(e) {
            window.history.back();
            console.log(window.history.state);
          });
        }
      });
    })();
  </script>
</polymer-element>
