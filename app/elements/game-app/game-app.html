<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="../../bower_components/core-animated-pages/core-animated-pages.html">
<link rel="import" href="../../bower_components/core-animated-pages/transitions/slide-from-right.html">

<link rel="import" href="../page-authorize/page-authorize.html">
<link rel="import" href="../page-rooms/page-rooms.html">
<link rel="import" href="../page-game/page-game.html">


<polymer-element name="game-app" attributes="">
  <template>
    <link rel="stylesheet" href="game-app.css">

    <core-animated-pages id="pages" fit selected="1" transitions="slide-from-right">
      <section>
        <page-authorize fit slide-from-right user="{{user}}"></page-authorize>
      </section>
      <section>
        <page-rooms slide-from-right user="{{user}}"></page-rooms>
      </section>
      <section>
        <page-game slide-from-right user="{{user}}"></page-game>
      </section>
    </core-animated-pages>

  </template>
  <script src="../../bower_components/director/build/director.js"></script>
  <script>
    var debugApp;
    (function () {
      Polymer({
        user: null,

        ready: function () {
          var app = this;
          /// TODO: remove
          debugApp = this;

          var routes = {
            'authorize': function () {
              app.$.pages.selected = 0;
            },
            'rooms': function () {
              app.$.pages.selected = 1;
            },
            'game': function () {
              app.$.pages.selected = 2;
            }
          };

          this.addEventListener('change-route', function (e) {
            if (e.detail) {
              if (routes[e.detail]) {
                //window.history.pushState({route: routes[e.detail]}, routes[e.detail]);
                routes[e.detail]();
              }
            }
          });

          this.addEventListener('change-route-back', function (e) {
            window.history.back();
            console.log(window.history.state);
          });
        }
      });
    })();
  </script>
</polymer-element>
